import serial
import time
import pandas as pd

def read_arduino(arduino):
    arduino_bytes = arduino.readline() # read line of arduino serial
    arduino_decode = arduino_bytes.decode()
    [s, v] = arduino_decode.split(',') # isolate sensor name and voltage val
    v = float(v)

    return s, v

sensors = []
vals = []

#initialise dataframe for storage of data
all_sensors = pd.DataFrame(columns = ['Sensor', 'Value'])

while True:
    arduino = serial.Serial('COM5', 9600) # read com5 (could also be com4)
    sensor, val = read_arduino(arduino)
    if sensor == 'A1': #get 13 sensor values
        count = 1
        sensors.append(sensor)
        vals.append(val)
        while count != 13:
            sensor, val = read_arduino(arduino)
            sensors.append(sensor)
            vals.append(val)
            count += 1
        # now have list of sensors and list of vals to put in dataframe
        sensors13 = pd.DataFrame(list(zip(sensors, vals)), columns = ['Sensor', 'Value'])
        all_sensors = all_sensors.append(sensors13)
        sensors = []
        vals = []

        #ml
        #ui

    else:
        sensor, val = read_arduino(arduino)
    arduino.close()

# excel export at log out stage